<?php
/**
 * Magento
 *
 * NOTICE OF LICENSE
 *
 * This source file is subject to the Academic Free License (AFL 3.0)
 * that is bundled with this package in the file LICENSE_AFL.txt.
 * It is also available through the world-wide-web at this URL:
 * http://opensource.org/licenses/afl-3.0.php
 * If you did not receive a copy of the license and are unable to
 * obtain it through the world-wide-web, please send an email
 * to license@magentocommerce.com so we can send you a copy immediately.
 *
 * DISCLAIMER
 *
 * Do not edit or add to this file if you wish to upgrade Magento to newer
 * versions in the future. If you wish to customize Magento for your
 * needs please refer to http://www.magentocommerce.com for more information.
 *
 * @category    design
 * @package     base_default
 * @copyright   Copyright (c) 2014 Magento Inc. (http://www.magentocommerce.com)
 * @license     http://opensource.org/licenses/afl-3.0.php  Academic Free License (AFL 3.0)
 */
?>
<?php if (count($this->getItemCollection()->getItems())): ?>
    <h3><?php echo $this->__('You may also be interested in the following product(s)') ?></h3>
    <?php if (Mage::getStoreConfig('megatronlayout/options/upsell_products_style') == 'big'): ?>
        <!-- Related Products '1 visible item' style -->
        <div class="row">
            <div class="product-carousel">
                <?php $this->resetItemsIterator() ?>
                <?php for ($_i = 0; $_i < $this->getRowCount(); $_i++): ?>
                    <?php for ($_j = 0; $_j < $this->getColumnCount(); $_j++): ?>
                        <?php if ($_link = $this->getIterableItem()): ?>
                            <?php if (!$_link->isSaleable() && !Mage::getStoreConfig('cataloginventory/options/show_out_of_stock')) continue; ?>
                            <?php
                            $widthBig = 263;
                            $heightBig = 319;
                            $price = $this->getPriceHtml($_link, true);
                            ?>
                            <?php
                            /*
                             * Product Preview HTML  is using in many blocks (category listing, shortcodes).
                             * That is why Product Preview HTML generation collected in one function drawProductPreview()
                             * You can edit this function  in file \app\code\local\Etheme\Megatronconfig\Helper\Data.php
                            */
                            ?>
                            <?php echo Mage::helper('megatronconfig')->drawProductPreview($_link, $this, $widthBig, $heightBig, $price, false, '', true) ?>

                        <?php endif; ?>
                    <?php endfor; ?>
                <?php endfor; ?>
            </div>
        </div>
    <?php else: ?>


        <div class="products-list-small add_after_quick_view_section">
            <ul class="slides">
                <?php
                $quick_view=Mage::getStoreConfig('megatronconfig/options/quick_view');
                $quick_view_style=Mage::getStoreConfig('megatronconfig/options/quick_view_style');




                $this->resetItemsIterator() ;
                ?>
                <?php for ($_i = 0; $_i < $this->getRowCount(); $_i++): ?>
                    <?php for ($_j = 0; $_j < $this->getColumnCount(); $_j++): ?>
                        <?php if ($_link = $this->getIterableItem()): ?>
                            <li>
                                <div class="product-preview">
                                    <div class="preview animate scale">
                                        <a href="<?php echo $_link->getProductUrl() ?>" title="<?php echo $this->escapeHtml($_link->getName()) ?>" class="product-image"><img src="<?php echo $this->helper('catalog/image')->init($_link, 'small_image')->resize(126,153) ?>"  alt="<?php echo $this->escapeHtml($_link->getName()) ?>" /></a>

                                        <?php if(Mage::getStoreConfig('megatronconfig/options/quick_view')):?>
                                            <a
                                                <?php
                                                if($quick_view && $quick_view_style=='in')
                                                {
                                                    echo 'href="'.$this->getUrl('ajax/index/options', array('product_id' => $_link->getId())).'"  class="quick-view hidden-xs"';
                                                }elseif($quick_view && $quick_view_style=='out')
                                                {
                                                    echo '<a href="'.$this->getUrl('ajax/index/popup', array('product_id' => $_link->getId())).'"  class="quick-view hidden-xs fancybox fancybox.ajax"';
                                                }
                                                ?>
                                            >
                                                 <span class="icon-zoom-in-2"></span> <?php echo $this->__('View') ?>
                                            </a>
                                        <?php endif;?>

                                    </div>
                                </div>
                            </li>

                        <?php endif; ?>
                    <?php endfor; ?>
                <?php endfor; ?>
            </ul>
        </div>

        <div class="product-view-ajax-container"><div class="product-view-ajax"><div class="ajax-loader progress progress-striped active"><div class="progress-bar progress-bar-danger" role="progressbar"></div> </div><div class="layar"></div><div class="product-view-container"> </div></div></div>

    <?php endif; ?>
<?php endif ?>
